import { blake2b } from "@noble/hashes/blake2b";
import { SignerWithProvider } from "./signer-with-provider.js";
import { toSerializedSignature } from "../cryptography/utils.js";
class RawSigner extends SignerWithProvider {
  constructor(keypair, provider) {
    super(provider);
    this.keypair = keypair;
  }
  async getAddress() {
    return this.keypair.getPublicKey().toSuiAddress();
  }
  async signData(data) {
    const pubkey = this.keypair.getPublicKey();
    const digest = blake2b(data, { dkLen: 32 });
    const signature = this.keypair.signData(digest);
    const signatureScheme = this.keypair.getKeyScheme();
    return toSerializedSignature({
      signatureScheme,
      signature,
      pubKey: pubkey
    });
  }
  connect(provider) {
    return new RawSigner(this.keypair, provider);
  }
}
export {
  RawSigner
};
//# sourceMappingURL=raw-signer.js.map
